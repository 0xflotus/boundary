# ***
# WARNING: Do not EDIT or MERGE this file, it is generated by packagespec.
# ***
lockid: 97feaa0367c8f452
packagespec-version: 0.1.3
cache-version: 8
packages:
- packagespecid: 082652163f13f0d93dfcc6ce7898979e02059661
  inputs:
    BINARY_NAME: boundary
    BUILD_TAGS: ui
    CGO_ENABLED: "0"
    GOARCH: amd64
    GOOS: darwin
    PRODUCT_NAME: boundary
    PRODUCT_VERSION: 0.0.1
    PRODUCT_VERSION_MMP: 0.0.1
    PRODUCT_VERSION_PRE: '"''''"'
  meta:
    BUILD_JOB_NAME: darwin_amd64_package
    BUNDLE_NAME: boundary_0.0.1
    POST_PROCESSORS: apple-notarize av-scan
    builtin:
      BUILD_LAYERS:
      - type: copy-source
        name: 03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d
        archive: .buildcache/archives/03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d.tar.gz
      - type: download-modules
        name: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
        archive: .buildcache/archives/02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6.tar.gz
      - type: compile-ui
        name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
        archive: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
      PACKAGE_CACHE_KEY_FILE: .buildcache/cache-keys/package-082652163f13f0d93dfcc6ce7898979e02059661
    circleci:
      BUILDER_CACHE_KEY_PREFIX_LIST:
      - copy-source_83a7_{{checksum ".buildcache/cache-keys/copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d"}}
      - download-modules_40d9_{{checksum ".buildcache/cache-keys/download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6"}}
      - compile-ui_0c3b_{{checksum ".buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68"}}
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
      PACKAGE_CACHE_KEY: package-082652163f13f0d93dfcc6ce7898979e02059661-{{checksum
        ".buildcache/cache-keys/package-082652163f13f0d93dfcc6ce7898979e02059661"}}
  build-command: VERSION_PKG_PATH=github.com/hashicorp/boundary/version; unset GOPATH;
    go build -x -tags 'ui' -ldflags "-X $VERSION_PKG_PATH.GitCommit=$PACKAGE_SOURCE_ID
    -X $VERSION_PKG_PATH.Version=0.0.1 -X $VERSION_PKG_PATH.VersionPrerelease="''""
    -o $OUTPUT_DIR/boundary ./cmd/boundary && cd $OUTPUT_DIR && zip $PACKAGE_ZIP_NAME
    boundary
  aliases:
  - type: local
    path: boundary_0.0.1_darwin_amd64.zip
  - type: public-hc-releases
    path: boundary/boundary_0.0.1/boundary_0.0.1_darwin_amd64.zip
- packagespecid: 83812b0d179e059b28974a1114c8752e120bb8d3
  inputs:
    BINARY_NAME: boundary
    BUILD_TAGS: ui
    CGO_ENABLED: "0"
    GOARCH: amd64
    GOOS: linux
    PRODUCT_NAME: boundary
    PRODUCT_VERSION: 0.0.1
    PRODUCT_VERSION_MMP: 0.0.1
    PRODUCT_VERSION_PRE: '"''''"'
  meta:
    BUILD_JOB_NAME: linux_amd64_package
    BUNDLE_NAME: boundary_0.0.1
    POST_PROCESSORS: av-scan
    builtin:
      BUILD_LAYERS:
      - type: copy-source
        name: 03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d
        archive: .buildcache/archives/03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d.tar.gz
      - type: download-modules
        name: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
        archive: .buildcache/archives/02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6.tar.gz
      - type: compile-ui
        name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
        archive: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
      PACKAGE_CACHE_KEY_FILE: .buildcache/cache-keys/package-83812b0d179e059b28974a1114c8752e120bb8d3
    circleci:
      BUILDER_CACHE_KEY_PREFIX_LIST:
      - copy-source_83a7_{{checksum ".buildcache/cache-keys/copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d"}}
      - download-modules_40d9_{{checksum ".buildcache/cache-keys/download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6"}}
      - compile-ui_0c3b_{{checksum ".buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68"}}
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
      PACKAGE_CACHE_KEY: package-83812b0d179e059b28974a1114c8752e120bb8d3-{{checksum
        ".buildcache/cache-keys/package-83812b0d179e059b28974a1114c8752e120bb8d3"}}
  build-command: VERSION_PKG_PATH=github.com/hashicorp/boundary/version; unset GOPATH;
    go build -x -tags 'ui' -ldflags "-X $VERSION_PKG_PATH.GitCommit=$PACKAGE_SOURCE_ID
    -X $VERSION_PKG_PATH.Version=0.0.1 -X $VERSION_PKG_PATH.VersionPrerelease="''""
    -o $OUTPUT_DIR/boundary ./cmd/boundary && cd $OUTPUT_DIR && zip $PACKAGE_ZIP_NAME
    boundary
  aliases:
  - type: local
    path: boundary_0.0.1_linux_amd64.zip
  - type: public-hc-releases
    path: boundary/boundary_0.0.1/boundary_0.0.1_linux_amd64.zip
base-image: golang@sha256:29452ef08bd0535f550c47b6034522c82ac10517b49c5f3b7a00035ecee0089e
layers:
- depth: 0
  final: false
  type: configure
  id: 7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
  name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
  parentname: ""
  parenttype: ""
  parentid: ""
  cachekeyfile: .buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
  sourceinclude: ""
  sourceexclude: ""
  archivefile: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
  dockerfile: |
    FROM golang@sha256:29452ef08bd0535f550c47b6034522c82ac10517b49c5f3b7a00035ecee0089e
    COPY . ./
    ENV GO111MODULE=on GOPRIVATE=github.com/hashicorp/* GOPATH=
    RUN --mount=type=ssh \
        curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg \
         | apt-key add - \
        && echo "deb https://dl.yarnpkg.com/debian/ stable main" \
         | tee /etc/apt/sources.list.d/yarn.list \
        && apt-get update \
        && apt-get install -yq yarn zip \
        && mkdir -m 700 /root/.ssh \
        && touch -m 600 /root/.ssh/known_hosts \
        && ssh-keyscan github.com > /root/.ssh/known_hosts \
        && git config --global url."git@github.com:".insteadOf https://github.com/
        && go get github.com/go-bindata/go-bindata/v3/go-bindata
  meta:
    builtin:
      LAYER_LIST:
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
    circleci:
      CACHE_KEY_PREFIX_LIST:
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
  childcount: 1
- depth: 1
  final: false
  type: compile-ui
  id: 0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
  name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
  parentname: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
  parenttype: configure
  parentid: 7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
  cachekeyfile: .buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
  sourceinclude: internal/ui/VERSION
  sourceexclude: ""
  archivefile: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
  dockerfile: |
    # syntax=docker/dockerfile:1.1.7-experimental
    ARG BASE_IMAGE
    FROM $BASE_IMAGE
    COPY . ./
    RUN --mount=type=ssh \
        SHA="$(head -n1 internal/ui/VERSION | cut -d ' ' -f1)" \
        && DIR=internal/ui/source/boundary-ui \
        && mkdir -p "$(dirname "$DIR")" \
        && git clone https://github.com/hashicorp/boundary-ui "$DIR" \
        && cd "$DIR" \
        && git fetch origin "$SHA" \
        && git checkout "$SHA" \
        && yarn install
        && yarn build:ui:core
        && TARGET=internal/ui/assets.go \
        && UIDIR="$DIR/ui/core/dist" \
        && go-bindata -fs -o "$TARGET" -pkg ui -prefix "$UIDIR" "$UIDIR" "$UIDIR/assets" \
        && rm -rf "$DIR"
  meta:
    builtin:
      LAYER_LIST:
      - type: compile-ui
        name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
        archive: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
    circleci:
      CACHE_KEY_PREFIX_LIST:
      - compile-ui_0c3b_{{checksum ".buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68"}}
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
  childcount: 1
- depth: 2
  final: false
  type: download-modules
  id: 40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
  name: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
  parentname: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
  parenttype: compile-ui
  parentid: 0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
  cachekeyfile: .buildcache/cache-keys/download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
  sourceinclude: go.mod go.sum
  sourceexclude: ""
  archivefile: .buildcache/archives/02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6.tar.gz
  dockerfile: |
    # syntax=docker/dockerfile:1.1.7-experimental
    ARG BASE_IMAGE
    FROM $BASE_IMAGE
    COPY . ./
    RUN --mount=type=ssh go mod download -x
  meta:
    builtin:
      LAYER_LIST:
      - type: download-modules
        name: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
        archive: .buildcache/archives/02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6.tar.gz
      - type: compile-ui
        name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
        archive: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
    circleci:
      CACHE_KEY_PREFIX_LIST:
      - download-modules_40d9_{{checksum ".buildcache/cache-keys/download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6"}}
      - compile-ui_0c3b_{{checksum ".buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68"}}
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
  childcount: 1
- depth: 3
  final: true
  type: copy-source
  id: 83a7c01653ccf71fa7878c361105f49781c5d31d
  name: 03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d
  parentname: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
  parenttype: download-modules
  parentid: 40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
  cachekeyfile: .buildcache/cache-keys/copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d
  sourceinclude: '*.go'
  sourceexclude: ""
  archivefile: .buildcache/archives/03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d.tar.gz
  dockerfile: |
    # syntax=docker/dockerfile:1.1.7-experimental
    ARG BASE_IMAGE
    FROM $BASE_IMAGE
    COPY . ./
    RUN go build -x -tags 'ui' ./cmd/boundary
  meta:
    builtin:
      LAYER_LIST:
      - type: copy-source
        name: 03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d
        archive: .buildcache/archives/03-copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d.tar.gz
      - type: download-modules
        name: 02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6
        archive: .buildcache/archives/02-download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6.tar.gz
      - type: compile-ui
        name: 01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68
        archive: .buildcache/archives/01-compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68.tar.gz
      - type: configure
        name: 00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc
        archive: .buildcache/archives/00-configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc.tar.gz
    circleci:
      CACHE_KEY_PREFIX_LIST:
      - copy-source_83a7_{{checksum ".buildcache/cache-keys/copy-source-83a7c01653ccf71fa7878c361105f49781c5d31d"}}
      - download-modules_40d9_{{checksum ".buildcache/cache-keys/download-modules-40d975c2951ab8bf3f637a87d035ffcc1f9e24c6"}}
      - compile-ui_0c3b_{{checksum ".buildcache/cache-keys/compile-ui-0c3b7abe2ca03ba110ba8adfb48b8b66b4c06d68"}}
      - configure_7efd_{{checksum ".buildcache/cache-keys/configure-7efdcf3de239f1a1ae8e9bbd3d9d0dea213b0fdc"}}
  childcount: 0
